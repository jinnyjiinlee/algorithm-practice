SELECT  
    B.AUTHOR_ID 
    , A.AUTHOR_NAME 
    , B.CATEGORY 
    , B.PRICE * COUNT(BS.SALES) AS TOTAL_SALES 
    
FROM BOOK B

JOIN AUTHOR A ON B.AUTHOR_ID = A.AUTHOR_ID
JOIN BOOK_SALES BS ON B.BOOK_ID = BS.BOOK_ID

WHERE DATE_FORMAT(BS.SALES_DATE, '%Y-%m') = '2022-01 '

GROUP BY A.AUTHOR_NAME, B.CATEGORY

ORDER BY B.AUTHOR_ID, B.CATEGORY DESC

















